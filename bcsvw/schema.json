{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://behaverse.org/schemas/bcsvw/schema.json",
  "title": "BCSVW Table Schema",
  "description": "JSON Schema for BCSVW (Behaverse CSV for the Web) metadata files",
  "version": "25.1201",
  "type": "object",
  "properties": {
    "@context": {
      "type": "string",
      "description": "JSON-LD context URL",
      "default": "https://behaverse.org/schemas/bcsvw/context.jsonld"
    },
    "name": {
      "type": "string",
      "description": "Short URL-friendly identifier",
      "pattern": "^[a-z0-9-_]+$"
    },
    "url": {
      "type": "string",
      "description": "URL or path to the CSV file"
    },
    "pretty_name": {
      "type": "string",
      "description": "Human-readable title for the table"
    },
    "description": {
      "type": "string",
      "description": "Detailed description of the table contents"
    },
    "date_created": {
      "type": "string",
      "format": "date",
      "description": "Date the table was created"
    },
    "creator": {
      "oneOf": [
        {
          "type": "string",
          "description": "Person or organization name (simple format)"
        },
        {
          "type": "array",
          "description": "Array of creator objects with detailed information",
          "items": {
            "type": "object",
            "required": ["name"],
            "properties": {
              "name": {
                "type": "string",
                "description": "Creator full name"
              },
              "email": {
                "type": "string",
                "format": "email",
                "description": "Creator email address"
              },
              "orcid": {
                "type": "string",
                "pattern": "^\\d{4}-\\d{4}-\\d{4}-\\d{3}[0-9X]$",
                "description": "ORCID identifier"
              },
              "affiliation": {
                "type": "string",
                "description": "Institutional affiliation"
              }
            }
          }
        }
      ],
      "description": "Person or organization that created the table (string or array of objects)"
    },
    "file_hash": {
      "type": "string",
      "description": "SHA-256 hash of the CSV file for integrity verification"
    },
    "license": {
      "type": "string",
      "description": "License identifier in SPDX format (e.g., CC-BY-4.0, MIT, Apache-2.0)"
    },
    "table_schema": {
      "type": "object",
      "description": "Schema describing the structure and properties of columns in the CSV table",
      "required": ["columns"],
      "properties": {
        "columns": {
          "type": "array",
          "minItems": 1,
          "items": {
            "$ref": "#/definitions/column"
          }
        },
        "primaryKey": {
          "oneOf": [
            { "type": "string" },
            { "type": "array", "items": { "type": "string" } }
          ],
          "description": "Column name(s) that form the primary key"
        }
      }
    }
  },
  "required": ["url", "table_schema"],
  "definitions": {
    "column": {
      "type": "object",
      "required": ["name"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Column name (must match CSV header)"
        },
        "label": {
          "type": "string",
          "description": "Human-readable label"
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the column"
        },
        "datatype": {
          "type": "string",
          "enum": ["string", "integer", "number", "boolean", "date", "datetime", "time", "categorical", "ordered"],
          "description": "Data type of the column"
        },
        "format": {
          "type": "string",
          "description": "Format pattern or constraint for values"
        },
        "unit": {
          "type": "string",
          "description": "Unit of measurement (e.g., 'kg', 'Â°C', 'mol/L')"
        },
        "levels": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Factor levels for categorical variables"
        },
        "minimum": {
          "type": "number",
          "description": "Minimum value for numeric columns"
        },
        "maximum": {
          "type": "number",
          "description": "Maximum value for numeric columns"
        },
        "minLength": {
          "type": "integer",
          "minimum": 0,
          "description": "Minimum string length"
        },
        "maxLength": {
          "type": "integer",
          "minimum": 0,
          "description": "Maximum string length"
        },
        "min_length": {
          "type": "integer",
          "minimum": 0,
          "description": "Minimum string length (snake_case alias for minLength)"
        },
        "max_length": {
          "type": "integer",
          "minimum": 0,
          "description": "Maximum string length (snake_case alias for maxLength)"
        },
        "null": {
          "oneOf": [
            { "type": "string" },
            { "type": "array", "items": { "type": "string" } }
          ],
          "description": "String(s) representing null values"
        },
        "na_strings": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Additional missing value codes"
        },
        "required": {
          "type": "boolean",
          "description": "Whether column values are required (not null)"
        },
        "virtual": {
          "type": "boolean",
          "description": "Whether column is virtual (not in CSV)"
        }
      }
    }
  }
}
